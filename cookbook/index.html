<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0a0a0f">
    <meta name="color-scheme" content="dark">
    <title>CookBook â€” ToolKit</title>

    <link rel="icon" type="image/x-icon" href="../favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
    <link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
    <link rel="manifest" href="../manifest.json">

    <link rel="stylesheet" href="../shared/css/index.css">
    <link rel="stylesheet" href="cookbook.css">
</head>
<body>
    <div class="bg-orbs">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
    </div>

    <header class="app-header">
        <div class="app-header-inner">
            <div class="logo-group">
                <a href="/CookBook/" class="back-link">&larr; ToolKit</a>
                <h1 class="logo">Cook<span>book</span></h1>
            </div>
            <nav class="header-actions">
                <button class="btn-favorite" id="nav-favorites-btn" onclick="window.CookBook.toggleNavFavorites()" title="Show favorites only">&#9825;</button>
                <button class="btn btn-secondary" onclick="window.CookBook.showView('list')">All Recipes</button>
                <button class="btn" onclick="window.CookBook.openImportModal()">+ Add</button>
                <button class="btn btn-secondary" onclick="window.CookBook.openHelpModal()">?</button>
            </nav>
        </div>
    </header>

    <!-- Collapsible Filter Bar -->
    <div id="filter-bar" class="filter-bar">
        <div class="container">
            <div class="filter-toggle-bar">
                <button class="filter-toggle-btn" onclick="window.CookBook.toggleFilterBar()">
                    <span class="arrow">&#9660;</span>
                    <span>Search & Filter</span>
                </button>
                <span class="filter-status" id="filter-status"></span>
            </div>
        </div>
        <div class="filter-content" id="filter-content">
            <div class="container">
                <div class="search-box">
                    <input type="text" id="search-input" placeholder="Search recipes..." oninput="window.CookBook.applyFilters()">
                </div>
                <div class="filter-controls">
                    <select id="tag-filter" onchange="window.CookBook.applyFilters()">
                        <option value="">All Tags</option>
                    </select>
                    <select id="sort-select" onchange="window.CookBook.applyFilters()">
                        <option value="name-asc">Name (A-Z)</option>
                        <option value="name-desc">Name (Z-A)</option>
                        <option value="date-desc">Newest First</option>
                        <option value="date-asc">Oldest First</option>
                        <option value="time-asc">Quickest First</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <main>
        <div class="container">
            <div id="list-view">
                <div id="recipe-grid" class="recipe-grid"></div>
                <div id="empty-state" class="empty-state hidden">
                    <h2>No recipes found</h2>
                    <p>Try adjusting your search or filters, or click "+ Add" to import a new recipe.</p>
                </div>
            </div>

            <div id="detail-view" class="hidden">
                <div class="back-button" onclick="window.CookBook.showView('list')">
                    &larr; Back to recipes
                </div>
                <div id="recipe-detail" class="recipe-detail"></div>
            </div>
        </div>
    </main>

    <!-- Import Modal -->
    <div id="import-modal" class="modal-overlay">
        <div class="modal large">
            <div class="modal-header">
                <h2>Add Recipe</h2>
                <button class="modal-close" onclick="window.CookBook.closeImportModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="recipe-input">Paste recipe in import format:</label>
                    <textarea id="recipe-input" class="large" placeholder="===RECIPE===
title: Recipe Name
description: A brief description...
tags: quick, vegetarian, dinner
prep_time: 10 minutes
cook_time: 20 minutes
total_time: 30 minutes
servings: 4

===INGREDIENTS===
100g | flour
2 | eggs

===INSTRUCTIONS===
1. First step: Do this thing...
2. Second step: Then do this...
===END==="></textarea>
                </div>
                <div class="info-box">
                    <h3>Import Format</h3>
                    <p>Use the prompt guide in the Help section to get recipes in the correct format from Claude.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="window.CookBook.closeImportModal()">Cancel</button>
                <button class="btn" onclick="window.CookBook.importRecipe()">Import Recipe</button>
            </div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div id="edit-modal" class="modal-overlay">
        <div class="modal large">
            <div class="modal-header">
                <h2>Edit Recipe</h2>
                <button class="modal-close" onclick="window.CookBook.closeEditModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="edit-title">Title</label>
                    <input type="text" id="edit-title">
                </div>
                <div class="form-group">
                    <label for="edit-description">Description</label>
                    <textarea id="edit-description" style="min-height: 80px;"></textarea>
                </div>
                <div class="form-group">
                    <label for="edit-tags">Tags (comma separated)</label>
                    <input type="text" id="edit-tags" placeholder="quick, dinner, spicy">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-prep">Prep Time</label>
                        <input type="text" id="edit-prep" placeholder="10 minutes">
                    </div>
                    <div class="form-group">
                        <label for="edit-cook">Cook Time</label>
                        <input type="text" id="edit-cook" placeholder="20 minutes">
                    </div>
                    <div class="form-group">
                        <label for="edit-total">Total Time</label>
                        <input type="text" id="edit-total" placeholder="30 minutes">
                    </div>
                    <div class="form-group">
                        <label for="edit-servings">Servings</label>
                        <input type="number" id="edit-servings" min="1" max="100">
                    </div>
                </div>
                <div class="form-group">
                    <label for="edit-ingredients">Ingredients (one per line: quantity | name)</label>
                    <textarea id="edit-ingredients" class="large" placeholder="100g | flour
2 | eggs
- | salt to taste

===Optional Garnishes===
- | chopped herbs"></textarea>
                </div>
                <div class="form-group">
                    <label for="edit-instructions">Instructions (one per line: Title: description)</label>
                    <textarea id="edit-instructions" class="large" placeholder="Prepare Ingredients: Gather and measure everything.
Mix: Combine dry ingredients in a bowl.
Cook: Heat over medium for 10 minutes."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="window.CookBook.closeEditModal()">Cancel</button>
                <button class="btn" onclick="window.CookBook.saveEdit()">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="help-modal" class="modal-overlay">
        <div class="modal large">
            <div class="modal-header">
                <h2>Help & Prompt Guide</h2>
                <button class="modal-close" onclick="window.CookBook.closeHelpModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="tabs">
                    <button class="tab active" onclick="window.CookBook.handleTabClick('prompt-tab', event)">Claude Prompt</button>
                    <button class="tab" onclick="window.CookBook.handleTabClick('format-tab', event)">Format Reference</button>
                    <button class="tab" onclick="window.CookBook.handleTabClick('export-tab', event)">Export Data</button>
                </div>

                <div id="prompt-tab" class="tab-content active">
                    <p class="text-secondary mb-2">Copy this prompt and give it to Claude along with your recipe:</p>
                    <pre id="claude-prompt">Please convert this recipe into the following structured import format and put it in a code block. Parse the recipe carefully to extract all information:

===RECIPE===
title: [Recipe title]
description: [Brief 1-2 sentence description of the dish]
tags: [comma-separated tags, e.g.: quick, dinner, spicy, vegetarian, asian]
prep_time: [X minutes]
cook_time: [X minutes]
total_time: [X minutes]
servings: [number only, e.g., 4]

===INGREDIENTS===
[quantity with unit] | [ingredient name and notes]

Rules for ingredients:
- ALWAYS convert to strict metric units: grams (g), milliliters (ml), liters (L). NEVER use tbsp, tsp, cups, oz, lb, or any imperial/volume shorthand.
- Convert all measurements: 1 tbsp butter = 14g, 1 cup flour = 125g, 1 tsp salt = 6g, 1 tbsp oil = 13ml, 1 cup liquid = 240ml, etc.
- Format: "100g | flour" or "2 | eggs" or "13ml | olive oil"
- For countable items (eggs, cloves, leaves), just use the count: "2 | eggs"
- For items without quantities, use: "- | ingredient name"

===INGREDIENTS:Optional/Group Name===
[Use this format for optional ingredients or to group ingredients by section]

===INSTRUCTIONS===
1. Step Title: Step description...
2. Next Step: Description...

Rules for instructions:
- Number each step
- Include a brief title before the colon, then the detailed instruction
- Keep each step focused on one main action

===END===

Suggested tags to use (pick relevant ones):
- Meal type: breakfast, lunch, dinner, snack, dessert
- Diet: vegetarian, vegan, gluten-free, dairy-free, keto, low-carb
- Cuisine: asian, korean, japanese, italian, mexican, indian, american
- Speed: quick (under 30 min), meal-prep
- Style: comfort-food, healthy, spicy, one-pot, batch-cook

Here is the recipe to convert:</pre>
                    <button class="btn mt-2" onclick="window.CookBook.copyPrompt()">Copy Prompt</button>
                </div>

                <div id="format-tab" class="tab-content">
                    <h3 class="text-primary mb-2">Format Reference</h3>
                    <pre>===RECIPE===
title: The Recipe Name
description: Brief description of the dish.
tags: quick, dinner, asian, spicy
prep_time: 5 minutes
cook_time: 10 minutes
total_time: 15 minutes
servings: 2

===INGREDIENTS===
100g | all-purpose flour
2 | large eggs
13ml | olive oil
- | salt to taste

===INGREDIENTS:For the Sauce===
200g | tomato passata
2 cloves | garlic, minced

===INSTRUCTIONS===
1. Prepare Ingredients: Gather and measure all ingredients.
2. Mix Dry: Combine flour and salt in a bowl.
3. Add Wet: Create a well, add eggs and oil.
===END===

NOTES:
&#8226; Quantities are parsed for the multiplier (e.g., "100g" scales with servings)
&#8226; Use "-" for non-scalable items (garnishes, "to taste")
&#8226; Ingredient groups via "===INGREDIENTS:Group Name==="
&#8226; Instructions auto-number; include "Title: description" format
&#8226; Tags are comma-separated, used for filtering</pre>
                </div>

                <div id="export-tab" class="tab-content">
                    <h3 class="text-primary mb-2">Export & Backup</h3>
                    <p class="text-muted mb-2">Export all your recipes as a JSON backup file, or import a previously exported backup.</p>
                    <div class="form-actions">
                        <button class="btn" onclick="window.CookBook.exportAllRecipes()">Export All Recipes</button>
                        <button class="btn btn-secondary" onclick="document.getElementById('import-backup').click()">Import Backup</button>
                        <input type="file" id="import-backup" accept=".json" style="display:none" onchange="window.CookBook.importBackup(event)">
                    </div>
                    <p class="text-muted text-small mt-2">Recipes are stored in your browser's localStorage. Export regularly to avoid data loss.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="window.CookBook.closeHelpModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="delete-modal" class="modal-overlay">
        <div class="modal small">
            <div class="modal-header">
                <h2>Delete Recipe?</h2>
                <button class="modal-close" onclick="window.CookBook.closeDeleteModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete "<strong id="delete-recipe-name"></strong>"? This cannot be undone.</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="window.CookBook.closeDeleteModal()">Cancel</button>
                <button class="btn btn-danger" onclick="window.CookBook.confirmDelete()">Delete</button>
            </div>
        </div>
    </div>

    <script type="module" src="cookbook.js"></script>
</body>
</html>
